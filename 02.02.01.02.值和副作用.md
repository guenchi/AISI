## 表达式会返回值，但可能有副作用

&ensp;&ensp;&ensp;&ensp;Scheme 表达式结合了表达式和语句的特性。它们返回值，但它们也可以有副作用 —— 也就是说，它们能通过赋值改变变量或对象的状态。

&ensp;&ensp;&ensp;&ensp;在 Scheme 中，变量赋值操作是 set! ，读作“set-bang”。如果我们把 3 赋给变量 foo，我们这样写：
 
 &ensp;&ensp;&ensp;&ensp;(set! foo 3)
 
 &ensp;&ensp;&ensp;&ensp;这和 C 中的 foo=3; 非常像。
 
&ensp;&ensp;&ensp;&ensp;注意， (set! foo 3) 看上去像是函数调用，因为所有东西都使用前缀表达法，但这并不是一个真正的调用，这是另一种表达式。
 
&ensp;&ensp;&ensp;&ensp;你不应该在 Scheme 程序中使用太多赋值操作。就像我在之后解释的，这通常是不好风格的表现。我会展示怎样以一种不需要过多副作用的风格来编程。不过，如果你需要，它们就在那里。
 
&ensp;&ensp;&ensp;&ensp;当你编写一个修改参数值，而不仅仅是返回值的过程时，给它一个以感叹号结尾的名字是一种好的风格。这提醒你和任何读你的代码的人，该个过程改变已经存在的内容，而不仅仅是像一个新的数据结构一样返回一个值。大多数改变状态的 Scheme 标准过程都以这种方式命名。
 
&ensp;&ensp;&ensp;&ensp;但是，大多数 Scheme 过程不会修改任何东西。例如，标准过程 reverse 以表作为参数并返回反序的表。这就是说它返回了原始列表的反向副本，而没有修改原始列表。如果你编写了一个返回相同的表的过程，但以修改内容的方式使之反向，你最好称之为 reverse! 。这警告人们被传递给 reverse! 的表可能被改变。

&ensp;&ensp;&ensp;&ensp;另一个带副作用的过程例子是 display。display 取一个值，并将其以打印的形式写入屏幕或文件。如果你给它一个参数，它会写入“标准输出”；默认情况下，这是终端或其他展示方式。

&ensp;&ensp;&ensp;&ensp;例如，如果你想要给用户展示数字 1022 的打印表示，可以使用这个表达式

&ensp;&ensp;&ensp;&ensp;(display 1022)

&ensp;&ensp;&ensp;&ensp;执行此表达式的副作用是将 1022 写在用户的屏幕上。（display 自动将数字转化为字符串，以便你阅读。）

&ensp;&ensp;&ensp;&ensp;注意到，display 并没有以感叹号结尾，因为它并没有对你提供的参数产生副作用。你可以给它一个数据结构，并确信它不会进行修改；display 当然具有副作用，但是 —— 它改变的是它写入内容的显示屏（或文件）的状态。

&ensp;&ensp;&ensp;&ensp;display 相当灵活，能够写入许多常见的 Scheme 对象的打印表示，甚至是相当复杂的数据结构。

&ensp;&ensp;&ensp;&ensp;除其他外，display 还能打印字符串。（字符串是另一种 Scheme 对象。你可以在双引号之间写出字符串字面量，“ like this”，Scheme 创建一个字符串对象来存储字符序列。

&ensp;&ensp;&ensp;&ensp;表达式 (display "hello world") 有写入"hello world"到标准输出的副作用，标准输出通常是用户的显示器。

&ensp;&ensp;&ensp;&ensp;这让 display 在调试程序、小的示例及编写交互式程序中显得非常有用。一个相似的过程，write 被用于在文件中保存数据；数据能通过使用 read 被拷贝回内存中。

&ensp;&ensp;&ensp;&ensp;在之后的章节，我会通过传递第二参数给 display，告诉它在何处输入，来展示如何写入文件。就现在而言，你只需要使用带一个参数的 display。不要尝试传递给 display 几个东西，并期望它全都打印出来。
